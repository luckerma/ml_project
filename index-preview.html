<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.6.40">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="dcterms.date" content="2025-01-15">

    <title>Football: Can you guess the winner?</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      /* CSS for citations */
      div.csl-bib-body { }
      div.csl-entry {
        clear: both;
        margin-bottom: 0em;
      }
      .hanging-indent div.csl-entry {
        margin-left:2em;
        text-indent:-2em;
      }
      div.csl-left-margin {
        min-width:2em;
        float:left;
      }
      div.csl-right-inline {
        margin-left:2em;
        padding-left:1em;
      }
      div.csl-indent {
        margin-left: 2em;
      }    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7bfb9ce031f0150bcdd0059ffcd3ab40.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
     
      <meta name="citation_title" content="Football: Can you guess the winner?">
<meta name="citation_abstract" content="Predicting football match outcomes is a challenging task due to the complexity and variability inherent in the sport. This project uses machine learning to build models capable of predicting match results (home win, draw, or away win) using historical team and player statistics. The dataset includes 12,303 rows with 884 features, capturing aggregated metrics for home and away teams and players across multiple leagues.

Key challenges include class imbalance, feature complexity, and data heterogeneity. We explored several models, including Logistic Regression, Random Forest, XGBoost, and LightGBM, with Random Forest performing best in the competition, ranking 279th out of 832 submissions with an accuracy of 48.79%.

Feature engineering, data preprocessing, and hyperparameter tuning were critical to improving model performance. However, challenges such as poor prediction of draws and class imbalance persisted. This report highlights insights from model comparisons, the role of feature selection, and the trade-offs between interpretability and complexity.
">
<meta name="citation_author" content="Luca Uckermann">
<meta name="citation_author" content="Nikethan Nimalakumaran">
<meta name="citation_author" content="Jonas Möller">
<meta name="citation_publication_date" content="2025-01-15">
<meta name="citation_cover_date" content="2025-01-15">
<meta name="citation_year" content="2025">
<meta name="citation_online_date" content="2025-01-15">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Random forests;,citation_author=Leo Breiman;,citation_publication_date=2001;,citation_cover_date=2001;,citation_year=2001;,citation_issue=1;,citation_volume=45;,citation_journal_title=Machine Learning;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Challenge data;,citation_author=Challenge Data;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://challengedata.ens.fr/;">
<meta name="citation_reference" content="citation_title=Football : Can you guess the winner?;,citation_author=Qube Research Technologies Group;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://challengedata.ens.fr/participants/challenges/143/;">
<meta name="citation_reference" content="citation_title=XGBoost: A scalable tree boosting system;,citation_author=Tianqi Chen;,citation_author=Carlos Guestrin;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_conference_title=Proceedings of the 22nd ACM SIGKDD international conference on knowledge discovery and data mining;,citation_conference=ACM;">
<meta name="citation_reference" content="citation_title=Applied logistic regression;,citation_author=David W Hosmer;,citation_author=Stanley Lemeshow;,citation_author=Rodney X Sturdivant;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;">
<meta name="citation_reference" content="citation_title=LightGBM: A highly efficient gradient boosting decision tree;,citation_author=Guolin Ke;,citation_author=Qiwei Meng;,citation_author=Thomas Finley;,citation_author=Taifeng Wang;,citation_author=Wei Chen;,citation_author=Weidong Ma;,citation_author=Qiwei Ye;,citation_author=Tie-Yan Liu;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_conference_title=Advances in neural information processing systems;">
</head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Article Notebook</h6>

            <a href="./index.qmd" class="btn btn-primary quarto-download-embed" download="index.qmd">Download Source</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Football: Can you guess the winner?</h1>
            <p class="subtitle lead">UGE: M2 SIA - ML Project Report</p>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Authors</div>
          <div class="quarto-title-meta-heading">Affiliations</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">Luca Uckermann <a href="mailto:luca_simon.uckermann@smail.th-koeln.de" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0009-0005-2957-6331" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        University of Applied Sciences (TH Köln)
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Nikethan Nimalakumaran <a href="mailto:nimalakumaran@edu.univ-eiffel.fr" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Université Gustave Eiffel
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Jonas Möller <a href="mailto:jonas.moller@edu.univ-eiffel.fr" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Bielefeld University
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
                <div>
            <div class="quarto-title-meta-heading">Published</div>
            <div class="quarto-title-meta-contents">
              <p class="date">January 15, 2025</p>
            </div>
          </div>
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>

    <div>
      <div class="abstract">
        <div class="block-title">Abstract</div>
        <p>Predicting football match outcomes is a challenging task due to the complexity and variability inherent in the sport. This project uses machine learning to build models capable of predicting match results (home win, draw, or away win) using historical team and player statistics. The dataset includes 12,303 rows with 884 features, capturing aggregated metrics for home and away teams and players across multiple leagues.</p>
        <p>Key challenges include class imbalance, feature complexity, and data heterogeneity. We explored several models, including Logistic Regression, Random Forest, XGBoost, and LightGBM, with Random Forest performing best in the competition, ranking 279th out of 832 submissions with an accuracy of 48.79%.</p>
        <p>Feature engineering, data preprocessing, and hyperparameter tuning were critical to improving model performance. However, challenges such as poor prediction of draws and class imbalance persisted. This report highlights insights from model comparisons, the role of feature selection, and the trade-offs between interpretability and complexity.</p>
      </div>
    </div>


    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-problem-understanding" id="toc-introduction-problem-understanding" class="nav-link active" data-scroll-target="#introduction-problem-understanding"><span class="header-section-number">1</span> Introduction &amp; Problem Understanding</a>
  <ul class="collapse">
  <li><a href="#context-and-motivation" id="toc-context-and-motivation" class="nav-link" data-scroll-target="#context-and-motivation"><span class="header-section-number">1.1</span> Context and Motivation</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives"><span class="header-section-number">1.2</span> Objectives</a></li>
  <li><a href="#challenge-description" id="toc-challenge-description" class="nav-link" data-scroll-target="#challenge-description"><span class="header-section-number">1.3</span> Challenge Description</a></li>
  </ul></li>
  <li><a href="#data-exploration-preprocessing" id="toc-data-exploration-preprocessing" class="nav-link" data-scroll-target="#data-exploration-preprocessing"><span class="header-section-number">2</span> Data Exploration &amp; Preprocessing</a>
  <ul class="collapse">
  <li><a href="#dataset-overview" id="toc-dataset-overview" class="nav-link" data-scroll-target="#dataset-overview"><span class="header-section-number">2.1</span> Dataset Overview</a>
  <ul class="collapse">
  <li><a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda"><span class="header-section-number">2.1.1</span> Exploratory Data Analysis (EDA)</a></li>
  <li><a href="#correlation-analysis-for-player-metrics" id="toc-correlation-analysis-for-player-metrics" class="nav-link" data-scroll-target="#correlation-analysis-for-player-metrics"><span class="header-section-number">2.1.2</span> Correlation Analysis for Player Metrics</a></li>
  <li><a href="#feature-distributions-and-correlations-with-outcomes" id="toc-feature-distributions-and-correlations-with-outcomes" class="nav-link" data-scroll-target="#feature-distributions-and-correlations-with-outcomes"><span class="header-section-number">2.1.3</span> Feature Distributions and Correlations with Outcomes</a></li>
  <li><a href="#implications-for-feature-engineering" id="toc-implications-for-feature-engineering" class="nav-link" data-scroll-target="#implications-for-feature-engineering"><span class="header-section-number">2.1.4</span> Implications for Feature Engineering</a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning"><span class="header-section-number">2.1.5</span> Data Cleaning</a></li>
  <li><a href="#feature-engineering" id="toc-feature-engineering" class="nav-link" data-scroll-target="#feature-engineering"><span class="header-section-number">2.1.6</span> Feature Engineering</a></li>
  </ul></li>
  <li><a href="#methodological-approaches-with-pros-cons" id="toc-methodological-approaches-with-pros-cons" class="nav-link" data-scroll-target="#methodological-approaches-with-pros-cons"><span class="header-section-number">2.2</span> Methodological Approaches with Pros &amp; Cons</a>
  <ul class="collapse">
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression"><span class="header-section-number">2.2.1</span> Logistic Regression</a></li>
  <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest"><span class="header-section-number">2.2.2</span> Random Forest</a></li>
  <li><a href="#xgboost" id="toc-xgboost" class="nav-link" data-scroll-target="#xgboost"><span class="header-section-number">2.2.3</span> XGBoost</a></li>
  <li><a href="#lightgbm" id="toc-lightgbm" class="nav-link" data-scroll-target="#lightgbm"><span class="header-section-number">2.2.4</span> LightGBM</a></li>
  </ul></li>
  <li><a href="#comparison-of-models" id="toc-comparison-of-models" class="nav-link" data-scroll-target="#comparison-of-models"><span class="header-section-number">2.3</span> Comparison of Models</a></li>
  </ul></li>
  <li><a href="#model-selection-tuning-validation" id="toc-model-selection-tuning-validation" class="nav-link" data-scroll-target="#model-selection-tuning-validation"><span class="header-section-number">3</span> Model Selection, Tuning &amp; Validation</a>
  <ul class="collapse">
  <li><a href="#hyperparameter-tuning-strategy" id="toc-hyperparameter-tuning-strategy" class="nav-link" data-scroll-target="#hyperparameter-tuning-strategy"><span class="header-section-number">3.1</span> Hyperparameter Tuning Strategy</a></li>
  <li><a href="#validation-framework" id="toc-validation-framework" class="nav-link" data-scroll-target="#validation-framework"><span class="header-section-number">3.2</span> Validation Framework</a></li>
  <li><a href="#performance-metrics" id="toc-performance-metrics" class="nav-link" data-scroll-target="#performance-metrics"><span class="header-section-number">3.3</span> Performance Metrics</a></li>
  <li><a href="#results-of-hyperparameter-tuning" id="toc-results-of-hyperparameter-tuning" class="nav-link" data-scroll-target="#results-of-hyperparameter-tuning"><span class="header-section-number">3.4</span> Results of Hyperparameter Tuning</a></li>
  </ul></li>
  <li><a href="#final-chosen-solution-in-depth-analysis" id="toc-final-chosen-solution-in-depth-analysis" class="nav-link" data-scroll-target="#final-chosen-solution-in-depth-analysis"><span class="header-section-number">4</span> Final Chosen Solution &amp; In-Depth Analysis</a>
  <ul class="collapse">
  <li><a href="#best-performing-approach" id="toc-best-performing-approach" class="nav-link" data-scroll-target="#best-performing-approach"><span class="header-section-number">4.1</span> Best Performing Approach</a></li>
  <li><a href="#in-depth-model-evaluation" id="toc-in-depth-model-evaluation" class="nav-link" data-scroll-target="#in-depth-model-evaluation"><span class="header-section-number">4.2</span> In-Depth Model Evaluation</a>
  <ul class="collapse">
  <li><a href="#logistic-regression-1" id="toc-logistic-regression-1" class="nav-link" data-scroll-target="#logistic-regression-1"><span class="header-section-number">4.2.1</span> Logistic Regression</a></li>
  <li><a href="#random-forest-1" id="toc-random-forest-1" class="nav-link" data-scroll-target="#random-forest-1"><span class="header-section-number">4.2.2</span> Random Forest</a></li>
  <li><a href="#xgboost-1" id="toc-xgboost-1" class="nav-link" data-scroll-target="#xgboost-1"><span class="header-section-number">4.2.3</span> XGBoost</a></li>
  <li><a href="#lightgbm-1" id="toc-lightgbm-1" class="nav-link" data-scroll-target="#lightgbm-1"><span class="header-section-number">4.2.4</span> LightGBM</a></li>
  <li><a href="#feature-engineering-insights" id="toc-feature-engineering-insights" class="nav-link" data-scroll-target="#feature-engineering-insights"><span class="header-section-number">4.2.5</span> Feature Engineering Insights</a></li>
  </ul></li>
  <li><a href="#validation-and-leaderboard-results" id="toc-validation-and-leaderboard-results" class="nav-link" data-scroll-target="#validation-and-leaderboard-results"><span class="header-section-number">4.3</span> Validation and Leaderboard Results</a></li>
  <li><a href="#discussion-of-results" id="toc-discussion-of-results" class="nav-link" data-scroll-target="#discussion-of-results"><span class="header-section-number">4.4</span> Discussion of Results</a></li>
  <li><a href="#limitations" id="toc-limitations" class="nav-link" data-scroll-target="#limitations"><span class="header-section-number">4.5</span> Limitations</a></li>
  </ul></li>
  <li><a href="#conclusion-lessons-learned" id="toc-conclusion-lessons-learned" class="nav-link" data-scroll-target="#conclusion-lessons-learned"><span class="header-section-number">5</span> Conclusion &amp; Lessons Learned</a>
  <ul class="collapse">
  <li><a href="#key-insights" id="toc-key-insights" class="nav-link" data-scroll-target="#key-insights"><span class="header-section-number">5.1</span> Key Insights</a></li>
  <li><a href="#challenges-encountered" id="toc-challenges-encountered" class="nav-link" data-scroll-target="#challenges-encountered"><span class="header-section-number">5.2</span> Challenges Encountered</a></li>
  <li><a href="#future-work" id="toc-future-work" class="nav-link" data-scroll-target="#future-work"><span class="header-section-number">5.3</span> Future Work</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">6</span> References</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <section id="introduction-problem-understanding" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction &amp; Problem Understanding</h1>
<section id="context-and-motivation" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="context-and-motivation"><span class="header-section-number">1.1</span> Context and Motivation</h2>
<p>This report explores the use of machine learning to predict football match outcomes (home win, draw or away win) based on historical team and player statistics. The ability to create accurate predictive models can significantly benefit stakeholders such as sports analysts, bettors and team managers by providing valuable insight into potential match outcomes.</p>
</section>
<section id="objectives" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="objectives"><span class="header-section-number">1.2</span> Objectives</h2>
<p>The primary objective of this project is to build a robust prediction model capable of determining the outcome of football matches using real historical data. This model should generalize across leagues, divisions and competitive levels, ensuring consistent performance across different match scenarios.</p>
<p>Secondary objectives include:</p>
<ul>
<li>Evaluate the effectiveness of different machine learning techniques on sports data.</li>
<li>Identify the most influential features that drive match outcomes.</li>
<li>Provide actionable insights and lessons learned for future sports analytics projects.</li>
</ul>
</section>
<section id="challenge-description" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="challenge-description"><span class="header-section-number">1.3</span> Challenge Description</h2>
<p>The challenge from QTR <span class="citation" data-cites="challengedata143">(<a href="#ref-challengedata143" role="doc-biblioref">Technologies Group 2024</a>)</span> provides a rich dataset comprising football match data from numerous leagues around the world. The entire dataset is divided into two categories: <em>team</em> and <em>player</em> statistics. The first category contains <em>25</em> features, while the second contains <em>52</em> features. The provided data is aggregated by sum, average and standard deviation. The ultimate goal is to predict match results, represented as a vector: <code>[HOME_WINS, DRAW, AWAY_WINS]</code>. The data can be found on the Challenge Data platform <span class="citation" data-cites="challengedata">(<a href="#ref-challengedata" role="doc-biblioref">Data 2024</a>)</span>. Two benchmarks are provided: a simple “home win” prediction with an accuracy of <em>44%</em> and a gradient boosting tree model with an accuracy of <em>47.5%</em>.</p>
<p>Several challenges inherent in this dataset include:</p>
<ul>
<li><strong>Class Imbalance:</strong> Matches are not evenly distributed across home wins, draws and away wins, potentially biasing models.</li>
<li><strong>Data Heterogeneity:</strong> Leagues vary significantly in playing style, player skill and game dynamics.</li>
<li><strong>Feature Complexity:</strong> The dataset contains a mix of team and player statistics, requiring effective feature selection and engineering.</li>
<li><strong>Limited Test Information:</strong> No labels are provided for the test set, making it difficult to evaluate model performance.</li>
</ul>
</section>
</section>
<section id="data-exploration-preprocessing" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Data Exploration &amp; Preprocessing</h1>
<section id="dataset-overview" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="dataset-overview"><span class="header-section-number">2.1</span> Dataset Overview</h2>
<p>The dataset provided for this project includes football match statistics aggregated at both team and player levels, with separate data for home and away teams. The data is structured into four CSV files for home and away teams and players, along with two additional files containing the target labels. These labels represent match outcomes as one of three categories: home win, draw, or away win. The aim is to leverage this rich dataset to build a machine learning model capable of predicting match outcomes with high accuracy. The training dataset contains <strong>12,303 rows</strong> and <strong>884 features</strong>, comprising the given data. Each row corresponds to a match, and the target variable represents the match outcome as one of three classes: <code>HOME_WINS</code>, <code>DRAW</code>, or <code>AWAY_WINS</code>, encoded as <code>[0, 1, 2]</code>.</p>
<p>The target class distribution is imbalanced, with <strong>43.5% home wins</strong>, <strong>30.6% away wins</strong>, and <strong>25.9% draws</strong>. This imbalance required careful handling during the model training phase to prevent biased predictions towards the majority class.</p>
<section id="exploratory-data-analysis-eda" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="exploratory-data-analysis-eda"><span class="header-section-number">2.1.1</span> Exploratory Data Analysis (EDA)</h3>
<section id="key-feature-statistics" class="level4" data-number="2.1.1.1">
<h4 data-number="2.1.1.1" class="anchored" data-anchor-id="key-feature-statistics"><span class="header-section-number">2.1.1.1</span> Key Feature Statistics</h4>
<p>A quick summary of the training dataset revealed meaningful patterns in team performance metrics. The table below highlights the statistics for the top 10 features, all regarding the home team:</p>
<div id="tbl-feature-stats" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-feature-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Summary statistics for the top 10 features in the training dataset.
</figcaption>
<div aria-describedby="tbl-feature-stats-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Feature</strong></th>
<th><strong>Count</strong></th>
<th><strong>Mean</strong></th>
<th><strong>Std Dev</strong></th>
<th><strong>Min</strong></th>
<th><strong>25%</strong></th>
<th><strong>50%</strong></th>
<th><strong>75%</strong></th>
<th><strong>Max</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>SHOTS_TOTAL_season_sum</td>
<td>12,303</td>
<td>4.30</td>
<td>2.91</td>
<td>0.0</td>
<td>2.0</td>
<td>4.0</td>
<td>6.0</td>
<td>10.0</td>
</tr>
<tr class="even">
<td>SHOTS_INSIDEBOX_season_sum</td>
<td>12,303</td>
<td>3.82</td>
<td>3.07</td>
<td>0.0</td>
<td>1.0</td>
<td>3.0</td>
<td>6.0</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td>SHOTS_OFF_TARGET_season_sum</td>
<td>12,303</td>
<td>4.51</td>
<td>2.81</td>
<td>0.0</td>
<td>2.0</td>
<td>4.0</td>
<td>6.0</td>
<td>10.0</td>
</tr>
<tr class="even">
<td>SHOTS_ON_TARGET_season_sum</td>
<td>12,303</td>
<td>4.15</td>
<td>2.86</td>
<td>0.0</td>
<td>2.0</td>
<td>4.0</td>
<td>6.0</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td>SHOTS_OUTSIDEBOX_season_sum</td>
<td>12,303</td>
<td>4.01</td>
<td>3.04</td>
<td>0.0</td>
<td>1.0</td>
<td>4.0</td>
<td>6.0</td>
<td>10.0</td>
</tr>
<tr class="even">
<td>PASSES_season_sum</td>
<td>12,303</td>
<td>3.85</td>
<td>3.07</td>
<td>0.0</td>
<td>1.0</td>
<td>3.0</td>
<td>6.0</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td>SUCCESSFUL_PASSES_season_sum</td>
<td>12,303</td>
<td>3.67</td>
<td>3.03</td>
<td>0.0</td>
<td>1.0</td>
<td>3.0</td>
<td>6.0</td>
<td>10.0</td>
</tr>
<tr class="even">
<td>SAVES_season_sum</td>
<td>12,303</td>
<td>4.38</td>
<td>3.00</td>
<td>0.0</td>
<td>2.0</td>
<td>4.0</td>
<td>7.0</td>
<td>10.0</td>
</tr>
<tr class="odd">
<td>CORNERS_season_sum</td>
<td>12,303</td>
<td>4.50</td>
<td>2.80</td>
<td>0.0</td>
<td>2.0</td>
<td>4.0</td>
<td>6.0</td>
<td>10.0</td>
</tr>
<tr class="even">
<td>FOULS_season_sum</td>
<td>12,303</td>
<td>4.82</td>
<td>3.02</td>
<td>0.0</td>
<td>3.0</td>
<td>5.0</td>
<td>7.0</td>
<td>10.0</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p><a href="#tbl-feature-stats" class="quarto-xref">Table&nbsp;1</a> highlights the variability in team performance metrics, such as shots and passes, which are critical indicators for match outcomes.</p>
</section>
<section id="class-distribution" class="level4" data-number="2.1.1.2">
<h4 data-number="2.1.1.2" class="anchored" data-anchor-id="class-distribution"><span class="header-section-number">2.1.1.2</span> Class Distribution</h4>
<p>The class distribution, as shown in the plot below, reveals a significant imbalance in match outcomes:</p>
<div id="tbl-class-distribution" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-class-distribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Class distribution of match outcomes in the training dataset.
</figcaption>
<div aria-describedby="tbl-class-distribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Class</strong></th>
<th><strong>Count</strong></th>
<th><strong>Proportion</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Home Wins (0)</td>
<td>5,356</td>
<td>43.5%</td>
</tr>
<tr class="even">
<td>Away Wins (2)</td>
<td>3,761</td>
<td>30.6%</td>
</tr>
<tr class="odd">
<td>Draws (1)</td>
<td>3,186</td>
<td>25.9%</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div id="fig-class-distribution" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-class-distribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./resources/class_distribution.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Class Distribution"><img src="./resources/class_distribution.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-class-distribution-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Class Distribution
</figcaption>
</figure>
</div>
<p>The imbalance in target classes (see <a href="#tbl-class-distribution" class="quarto-xref">Table&nbsp;2</a> and <a href="#fig-class-distribution" class="quarto-xref">Figure&nbsp;1</a>) necessitated the use of stratified sampling during train-test splits to ensure fair representation of all classes.</p>
<p>Following the initial exploration of class imbalance in the dataset, we conducted a deeper analysis of certain features to assess their behavior and potential influence on match outcomes. This analysis aimed to provide a clearer understanding of the data’s structure and implications.</p>
</section>
</section>
<section id="correlation-analysis-for-player-metrics" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="correlation-analysis-for-player-metrics"><span class="header-section-number">2.1.2</span> Correlation Analysis for Player Metrics</h3>
<p>The first heatmap (<a href="#fig-player-correlation" class="quarto-xref">Figure&nbsp;2</a>) visualizes the correlation matrix of selected <strong>home player statistics</strong>, highlighting the relationships between features such as accurate crosses, aerials won, assists, and big chances created. A moderate correlation is observed between <strong>big chances created</strong> and <strong>assists</strong> (0.70), as well as between <strong>accurate crosses</strong> and <strong>big chances created</strong> (0.56). These relationships suggest that these metrics may jointly influence a team’s success, warranting their consideration in the feature engineering process.</p>
<div id="fig-player-correlation" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-player-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./resources/home_player_matrix.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: Correlation Matrix: Home Player"><img src="./resources/home_player_matrix.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-player-correlation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Correlation Matrix: Home Player
</figcaption>
</figure>
</div>
</section>
<section id="feature-distributions-and-correlations-with-outcomes" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="feature-distributions-and-correlations-with-outcomes"><span class="header-section-number">2.1.3</span> Feature Distributions and Correlations with Outcomes</h3>
<p>The following figures illustrate the distributions of selected <strong>home team statistics</strong> (e.g., <strong>shots total</strong>, <strong>shots inside the box</strong>, <strong>passes</strong>, and <strong>successful passes</strong>) and their correlations with the <strong>home wins</strong> target class. Key observations include:</p>
<ol type="1">
<li><p><strong>Feature Distributions:</strong> The distributions for metrics such as <strong>shots total</strong> and <strong>successful passes</strong> exhibit peaks at discrete values, reflecting their aggregation across matches. It can also be seen that of the selected metrics, the sum of shots a team made inside the box correlated most strongly with a home win.</p></li>
<li><p><strong>Correlations:</strong> The positive correlations between these features and <strong>home wins</strong> reinforce their potential importance in predicting match outcomes. For instance, metrics like <strong>shots inside the box</strong> have a notable correlation of approximately 0.2 with <strong>home wins</strong>, indicating their predictive relevance.</p></li>
</ol>
<p><img src="./resources/home_team_distribution.png" id="fig-feature-distribution" class="img-fluid" alt="Feature Distribution and Correlation Analysis 1"> <img src="./resources/home_team_matrix.png" id="fig-feature-correlation" class="img-fluid" alt="Feature Distribution and Correlation Analysis 2"></p>
</section>
<section id="implications-for-feature-engineering" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="implications-for-feature-engineering"><span class="header-section-number">2.1.4</span> Implications for Feature Engineering</h3>
<p>The insights from these analyses informed our feature engineering efforts by:</p>
<ul>
<li>Identifying key metrics with strong correlations to match outcomes.</li>
<li>Justifying the creation of <strong>difference</strong> and <strong>ratio</strong> features to capture the interplay between home and away team statistics.</li>
<li>Highlighting the importance of preserving the integrity of correlated features, such as <strong>big chances created</strong> and <strong>assists</strong>, during possible dimensionality reduction.</li>
</ul>
<p>Based on this we can ensure that relevant and impactful features are retained for the subsequent modelling phases.</p>
</section>
<section id="data-cleaning" class="level3" data-number="2.1.5">
<h3 data-number="2.1.5" class="anchored" data-anchor-id="data-cleaning"><span class="header-section-number">2.1.5</span> Data Cleaning</h3>
<p>During preprocessing, missing values in player statistics, such as <code>PLAYER_CAPTAIN</code>, were replaced with zeros. Aggregated player data was further combined with team statistics, ensuring a consistent structure for all matches. Outliers in features like <code>TEAM_SHOTS_TOTAL</code> were retained to preserve their influence on match outcomes. In addition, columns that were not used in the test data, such as the league or player names were dropped.</p>
</section>
<section id="feature-engineering" class="level3" data-number="2.1.6">
<h3 data-number="2.1.6" class="anchored" data-anchor-id="feature-engineering"><span class="header-section-number">2.1.6</span> Feature Engineering</h3>
<p>To enhance model performance, new features were engineered:</p>
<ol type="1">
<li><strong>Difference Features:</strong> Captured the performance disparity between home and away teams (e.g., <code>SHOTS_TOTAL_DIFF</code>).</li>
<li><strong>Ratio Features:</strong> Quantified proportional differences between home and away metrics (e.g., <code>SHOTS_TOTAL_RATIO</code>).</li>
</ol>
<p>These engineered features were critical in distinguishing competitive advantages, especially in closely matched games.</p>
</section>
</section>
<section id="methodological-approaches-with-pros-cons" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="methodological-approaches-with-pros-cons"><span class="header-section-number">2.2</span> Methodological Approaches with Pros &amp; Cons</h2>
<section id="logistic-regression" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="logistic-regression"><span class="header-section-number">2.2.1</span> Logistic Regression</h3>
<p><strong>Overview:</strong> Logistic Regression is a statistical model that is widely used for binary classification problems. It estimates the probability of an event occurring by fitting data to a logistic curve. For multiclass problems, extensions like multinomial logistic regression are employed.</p>
<p><strong>Advantages:</strong></p>
<ul>
<li>Simple and easy to interpret, making it ideal for understanding feature importance <span class="citation" data-cites="Hosmer2013">(<a href="#ref-Hosmer2013" role="doc-biblioref">Hosmer, Lemeshow, and Sturdivant 2013</a>)</span>.</li>
<li>Computationally efficient with minimal assumptions about data distribution.</li>
<li>Well-suited for smaller datasets with linearly separable features.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Assumes linearity between predictors and the log-odds, which can limit performance on non-linear data <span class="citation" data-cites="Hosmer2013">(<a href="#ref-Hosmer2013" role="doc-biblioref">Hosmer, Lemeshow, and Sturdivant 2013</a>)</span>.</li>
<li>Prone to underfitting when dealing with complex or high-dimensional datasets.</li>
</ul>
<hr>
</section>
<section id="random-forest" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="random-forest"><span class="header-section-number">2.2.2</span> Random Forest</h3>
<p><strong>Overview:</strong><br>
Random Forest is an ensemble learning method that constructs multiple decision trees and combines their predictions. It leverages the concept of “bagging” to improve predictive accuracy and control overfitting.</p>
<p><strong>Advantages:</strong></p>
<ul>
<li>Handles non-linear relationships and interactions effectively <span class="citation" data-cites="Breiman2001">(<a href="#ref-Breiman2001" role="doc-biblioref">Breiman 2001</a>)</span>.</li>
<li>Robust to overfitting due to averaging across trees.</li>
<li>Automatically ranks feature importance, providing insights into the data.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Computationally intensive, especially for large datasets or many trees <span class="citation" data-cites="Breiman2001">(<a href="#ref-Breiman2001" role="doc-biblioref">Breiman 2001</a>)</span>.</li>
<li>Less interpretable than simpler models like Logistic Regression.</li>
</ul>
<hr>
</section>
<section id="xgboost" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="xgboost"><span class="header-section-number">2.2.3</span> XGBoost</h3>
<p><strong>Overview:</strong><br>
XGBoost is an advanced implementation of gradient boosting designed for speed and efficiency. It builds trees iteratively, focusing on optimizing predictive accuracy through regularization and advanced optimization techniques.</p>
<p><strong>Advantages:</strong></p>
<ul>
<li>Achieves state-of-the-art predictive performance on structured datasets <span class="citation" data-cites="Chen2016">(<a href="#ref-Chen2016" role="doc-biblioref">Chen and Guestrin 2016</a>)</span>.</li>
<li>Regularization controls overfitting better than traditional gradient boosting.</li>
<li>Flexible with custom loss functions and supports parallel processing.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Requires extensive hyperparameter tuning, which can be computationally expensive <span class="citation" data-cites="Chen2016">(<a href="#ref-Chen2016" role="doc-biblioref">Chen and Guestrin 2016</a>)</span>.</li>
<li>Interpretability can be challenging without additional tools.</li>
</ul>
<hr>
</section>
<section id="lightgbm" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="lightgbm"><span class="header-section-number">2.2.4</span> LightGBM</h3>
<p><strong>Overview:</strong><br>
LightGBM (Light Gradient Boosting Machine) is a fast and efficient gradient boosting framework designed for large-scale datasets. It optimizes both accuracy and scalability by leveraging histogram-based learning.</p>
<p><strong>Advantages:</strong></p>
<ul>
<li>Significantly faster training and lower memory usage compared to XGBoost <span class="citation" data-cites="Ke2017">(<a href="#ref-Ke2017" role="doc-biblioref">Ke et al. 2017</a>)</span>.</li>
<li>Handles large datasets and sparse features effectively <span class="citation" data-cites="Ke2017">(<a href="#ref-Ke2017" role="doc-biblioref">Ke et al. 2017</a>)</span>.</li>
<li>Implements advanced techniques like Leaf-wise growth for higher accuracy.</li>
</ul>
<p><strong>Disadvantages:</strong></p>
<ul>
<li>Prone to overfitting, particularly on smaller datasets <span class="citation" data-cites="Ke2017">(<a href="#ref-Ke2017" role="doc-biblioref">Ke et al. 2017</a>)</span>.</li>
<li>Requires careful tuning to achieve optimal performance.</li>
</ul>
<hr>
</section>
</section>
<section id="comparison-of-models" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="comparison-of-models"><span class="header-section-number">2.3</span> Comparison of Models</h2>
<div id="tbl-model-comparison" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-model-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Comparison of key advantages, disadvantages, and best use cases for Logistic Regression, Random Forest, XGBoost, and LightGBM.
</figcaption>
<div aria-describedby="tbl-model-comparison-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 36%">
<col style="width: 29%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Model</strong></th>
<th><strong>Advantages</strong></th>
<th><strong>Disadvantages</strong></th>
<th><strong>Best Use Cases</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Logistic Regression</td>
<td>- Simple and interpretable <span class="citation" data-cites="Hosmer2013">(<a href="#ref-Hosmer2013" role="doc-biblioref">Hosmer, Lemeshow, and Sturdivant 2013</a>)</span>.</td>
<td>- Assumes linear relationships; struggles with complex, non-linear data <span class="citation" data-cites="Hosmer2013">(<a href="#ref-Hosmer2013" role="doc-biblioref">Hosmer, Lemeshow, and Sturdivant 2013</a>)</span>.</td>
<td>- Small datasets with linearly separable features or where interpretability is critical.</td>
</tr>
<tr class="even">
<td>Random Forest</td>
<td>- Captures non-linear relationships; robust to overfitting; handles categorical data well <span class="citation" data-cites="Breiman2001">(<a href="#ref-Breiman2001" role="doc-biblioref">Breiman 2001</a>)</span>.</td>
<td>- Computationally intensive; less interpretable compared to simpler models <span class="citation" data-cites="Breiman2001">(<a href="#ref-Breiman2001" role="doc-biblioref">Breiman 2001</a>)</span>.</td>
<td>- Medium to large datasets with diverse features; identifying important variables.</td>
</tr>
<tr class="odd">
<td>XGBoost</td>
<td>- High predictive performance; regularization to reduce overfitting; supports custom loss functions <span class="citation" data-cites="Chen2016">(<a href="#ref-Chen2016" role="doc-biblioref">Chen and Guestrin 2016</a>)</span>.</td>
<td>- Hyperparameter tuning is computationally expensive; less interpretable <span class="citation" data-cites="Chen2016">(<a href="#ref-Chen2016" role="doc-biblioref">Chen and Guestrin 2016</a>)</span>.</td>
<td>- Competitions or tasks requiring high accuracy and scalability.</td>
</tr>
<tr class="even">
<td>LightGBM</td>
<td>- Fast and efficient; handles large-scale datasets; optimized for sparse data <span class="citation" data-cites="Ke2017">(<a href="#ref-Ke2017" role="doc-biblioref">Ke et al. 2017</a>)</span>.</td>
<td>- Can overfit on small datasets; requires careful hyperparameter tuning <span class="citation" data-cites="Ke2017">(<a href="#ref-Ke2017" role="doc-biblioref">Ke et al. 2017</a>)</span>.</td>
<td>- Large, high-dimensional datasets or tasks involving sparse features.</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
</section>
<section id="model-selection-tuning-validation" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Model Selection, Tuning &amp; Validation</h1>
<section id="hyperparameter-tuning-strategy" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="hyperparameter-tuning-strategy"><span class="header-section-number">3.1</span> Hyperparameter Tuning Strategy</h2>
<p>To optimize model performance, we employed hyperparameter tuning using RandomizedSearchCV, a method that allows efficient exploration of hyperparameter spaces. Unlike exhaustive grid search, this approach samples a predefined number of configurations, significantly reducing computational cost while maintaining robust optimization.</p>
<p>The training dataset was split into training and validation subsets using stratified sampling to preserve the class distribution. First, a subset of the data (5% sample) was used for initial tuning to save computational resources, and the best singular model was retrained on the whole dataset. In a subsequent iteration of our modeling phase, we decided to perform hyperparameter tuning on the entire dataset and then train all models on the dataset. This is mainly due to the fact that after our first submission, the difference between our accuracy on the validation set and the final score from the challenge did not match well.</p>
<p>Below is the Python implementation of the hyperparameter tuning process:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define models and parameter distributions</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>models <span class="op">=</span> {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"LogisticRegression"</span>: {</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"estimator"</span>: LogisticRegression(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>          max_iter<span class="op">=</span><span class="dv">2000</span>, solver<span class="op">=</span><span class="st">"lbfgs"</span>, n_jobs<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">"param_dist"</span>: {</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">"C"</span>: loguniform(<span class="fl">1e-2</span>, <span class="fl">1e1</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"RandomForest"</span>: {</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"estimator"</span>: RandomForestClassifier(</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>          random_state<span class="op">=</span><span class="dv">42</span>, n_jobs<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"param_dist"</span>: {</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_estimators"</span>: randint(<span class="dv">50</span>, <span class="dv">300</span>),</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"max_depth"</span>: randint(<span class="dv">3</span>, <span class="dv">15</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"XGBClassifier"</span>: {</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"estimator"</span>: XGBClassifier(</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>          random_state<span class="op">=</span><span class="dv">42</span>, use_label_encoder<span class="op">=</span><span class="va">False</span>, eval_metric<span class="op">=</span><span class="st">"mlogloss"</span>, n_jobs<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>        <span class="st">"param_dist"</span>: {</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_estimators"</span>: randint(<span class="dv">50</span>, <span class="dv">300</span>),</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">"max_depth"</span>: randint(<span class="dv">3</span>, <span class="dv">15</span>),</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">"learning_rate"</span>: loguniform(<span class="fl">1e-3</span>, <span class="fl">1e-1</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"LGBMClassifier"</span>: {</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">"estimator"</span>: LGBMClassifier(</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>          random_state<span class="op">=</span><span class="dv">42</span>, n_jobs<span class="op">=-</span><span class="dv">1</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        <span class="st">"param_dist"</span>: {</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>            <span class="st">"n_estimators"</span>: randint(<span class="dv">50</span>, <span class="dv">300</span>),</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>            <span class="st">"max_depth"</span>: randint(<span class="dv">3</span>, <span class="dv">15</span>),</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>            <span class="st">"learning_rate"</span>: loguniform(<span class="fl">1e-3</span>, <span class="fl">1e-1</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of random iterations for hyperparameter search</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>n_iter_search <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> {}</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform hyperparameter tuning</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, cfg <span class="kw">in</span> models.items():</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Tuning </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> with RandomizedSearchCV..."</span>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    clf <span class="op">=</span> cfg[<span class="st">"estimator"</span>]</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    param_dist <span class="op">=</span> cfg[<span class="st">"param_dist"</span>]</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>    rs <span class="op">=</span> RandomizedSearchCV(</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>        estimator<span class="op">=</span>clf,</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>        param_distributions<span class="op">=</span>param_dist,</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>        n_iter<span class="op">=</span>n_iter_search,</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>        scoring<span class="op">=</span><span class="st">"accuracy"</span>,</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>        cv<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>        n_jobs<span class="op">=-</span><span class="dv">1</span>,</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>        random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>        verbose<span class="op">=</span><span class="dv">1</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>    rs.fit(X_train_s, y_train_s)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    best_model <span class="op">=</span> rs.best_estimator_</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>    val_preds <span class="op">=</span> best_model.predict(X_val_s)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    acc <span class="op">=</span> accuracy_score(y_val_s, val_preds)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>    f1 <span class="op">=</span> f1_score(y_val_s, val_preds, average<span class="op">=</span><span class="st">"macro"</span>)</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    results[name] <span class="op">=</span> {</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>        <span class="st">"best_params"</span>: rs.best_params_,</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>        <span class="st">"accuracy"</span>: acc,</span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>        <span class="st">"f1_score"</span>: f1,</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>        <span class="st">"best_estimator"</span>: best_model</span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>name<span class="sc">}</span><span class="ss"> tuned. Accuracy: </span><span class="sc">{</span>acc<span class="sc">:.4f}</span><span class="ss">, F1 Score: </span><span class="sc">{</span>f1<span class="sc">:.4f}</span><span class="ch">\n</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="validation-framework" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="validation-framework"><span class="header-section-number">3.2</span> Validation Framework</h2>
<p>To ensure robust evaluation, we employed k-fold cross-validation with three folds. This approach allowed us to test model performance across multiple data splits, reducing the risk of overfitting and providing a more reliable assessment of generalization. Stratified sampling was used to maintain the original class distribution in each fold, preventing biases caused by class imbalance.</p>
</section>
<section id="performance-metrics" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="performance-metrics"><span class="header-section-number">3.3</span> Performance Metrics</h2>
<p>To evaluate the models, we relied on two primary metrics:</p>
<ol type="1">
<li><p><strong>Accuracy:</strong> The proportion of correctly predicted outcomes out of the total predictions. While accuracy provides a general sense of model performance, it can be misleading in cases of imbalanced datasets like ours, where certain outcomes dominate.</p></li>
<li><p><strong>F1 Score (Macro Average):</strong> This metric considers the harmonic mean of precision and recall for all classes, treating them equally regardless of their frequency. The macro-average F1 score is particularly important for this project to ensure that the model performs well across all classes (Home Wins, Draws, and Away Wins).</p></li>
</ol>
<p>Additionally, confusion matrices were used to provide a detailed breakdown of predictions versus actual outcomes, highlighting strengths and weaknesses for each class.</p>
</section>
<section id="results-of-hyperparameter-tuning" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="results-of-hyperparameter-tuning"><span class="header-section-number">3.4</span> Results of Hyperparameter Tuning</h2>
<p>The table below summarizes the performance metrics for each model after hyperparameter tuning using the validation set:</p>
<div id="tbl-hyperparameter-tuning" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-hyperparameter-tuning-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Results of hyperparameter tuning for Logistic Regression, Random Forest, XGBoost, and LightGBM models.
</figcaption>
<div aria-describedby="tbl-hyperparameter-tuning-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 10%">
<col style="width: 17%">
<col style="width: 55%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Model</strong></th>
<th><strong>Accuracy</strong></th>
<th><strong>F1 Score (Macro)</strong></th>
<th><strong>Best Hyperparameters</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Logistic Regression</td>
<td>0.463</td>
<td>0.410</td>
<td><code>{'C': 0.115}</code></td>
</tr>
<tr class="even">
<td>Random Forest</td>
<td>0.505</td>
<td>0.0368</td>
<td><code>{'n_estimators': 10, 'max_depth': 201}</code></td>
</tr>
<tr class="odd">
<td>XGBoost</td>
<td>0.498</td>
<td>0.0363</td>
<td><code>{'n_estimators': 181, 'max_depth': 4, 'learning_rate': 0.008}</code></td>
</tr>
<tr class="even">
<td>LightGBM</td>
<td>0.503</td>
<td>0.0372</td>
<td><code>{'n_estimators': 180, 'max_depth': 11, 'learning_rate': 0.011}</code></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>These are the results for the hyperparameter tuning, <a href="#tbl-hyperparameter-tuning" class="quarto-xref">Table&nbsp;4</a> shows the model with the corresponding accuracy and F1 score and the best parameters. After the hyperparameter tuning, we trained those models with the best parameters on the whole dataset.</p>
</section>
</section>
<section id="final-chosen-solution-in-depth-analysis" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Final Chosen Solution &amp; In-Depth Analysis</h1>
<section id="best-performing-approach" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="best-performing-approach"><span class="header-section-number">4.1</span> Best Performing Approach</h2>
<p>After training the models on the full dataset and evaluating their performance both on a held-out validation set and the competition platform, the <strong>Random Forest</strong> emerged as the best-performing model with a competitive accuracy of <strong>0.4879</strong> on the challenge leaderboard. While other models such as XGBoost and LightGBM also performed reasonably well, Random Forest demonstrated better generalization and robustness when applied to unseen test data. It ranked <strong>279 out of 832 submissions</strong>, placing it significantly above the baseline model.</p>
</section>
<section id="in-depth-model-evaluation" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="in-depth-model-evaluation"><span class="header-section-number">4.2</span> In-Depth Model Evaluation</h2>
<section id="logistic-regression-1" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="logistic-regression-1"><span class="header-section-number">4.2.1</span> Logistic Regression</h3>
<p>Logistic Regression, despite its simplicity, struggled to capture the non-linear relationships in the data. Its accuracy on the validation set was <strong>45%</strong>, and its performance on the challenge platform was slightly lower at <strong>43.28%</strong>. The model demonstrated a preference for the majority class (Home Wins) but struggled with minority classes (Draws and Away Wins). The confusion matrix (<a href="#fig-logistic-regression-confusion-matrix" class="quarto-xref">Figure&nbsp;3</a>) revealed an imbalance in predictions, particularly for the Draw class, which significantly reduced its macro F1-score.</p>
<div id="fig-logistic-regression-confusion-matrix" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-logistic-regression-confusion-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="resources/Logistic_Regression.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: Confusion Matrix Logistic Regression"><img src="resources/Logistic_Regression.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-logistic-regression-confusion-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Confusion Matrix Logistic Regression
</figcaption>
</figure>
</div>
</section>
<section id="random-forest-1" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="random-forest-1"><span class="header-section-number">4.2.2</span> Random Forest</h3>
<p>Random Forest achieved a validation accuracy of <strong>49%</strong> and maintained this level of performance on the challenge platform with an accuracy of <strong>48.79%</strong>. The confusion matrix (<a href="#fig-random-forest-confusion-matrix" class="quarto-xref">Figure&nbsp;4</a>) indicated that Random Forest effectively captured the majority class (Home Wins) while achieving reasonable performance for Away Wins. However, it showed limited success in predicting Draws, as evidenced by the low recall for this class.</p>
<p>Key strengths of Random Forest include its ability to model complex feature interactions and to provide consistent performance across datasets, making it a reliable choice for this task.</p>
<div id="fig-random-forest-confusion-matrix" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-random-forest-confusion-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="resources/Random_Forest.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: Confusion Matrix Random Forest"><img src="resources/Random_Forest.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-random-forest-confusion-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Confusion Matrix Random Forest
</figcaption>
</figure>
</div>
</section>
<section id="xgboost-1" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="xgboost-1"><span class="header-section-number">4.2.3</span> XGBoost</h3>
<p>XGBoost performed similarly to Random Forest on both the validation set and the challenge platform, achieving leaderboard accuracy of <strong>48.49%</strong>. While XGBoost excelled in handling imbalanced data through boosting iterations, its computational overhead and sensitivity to hyperparameter tuning posed challenges. Its confusion matrix (<a href="#fig-xgboost-confusion-matrix" class="quarto-xref">Figure&nbsp;5</a>) revealed a similar pattern to Random Forest, with strong performance for Home Wins but weaker performance for Draws.</p>
<div id="fig-xgboost-confusion-matrix" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-xgboost-confusion-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="resources/XGBC.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: Confusion Matrix XGBoost"><img src="resources/XGBC.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-xgboost-confusion-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Confusion Matrix XGBoost
</figcaption>
</figure>
</div>
</section>
<section id="lightgbm-1" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="lightgbm-1"><span class="header-section-number">4.2.4</span> LightGBM</h3>
<p>LightGBM demonstrated competitive performance with a leaderboard accuracy of <strong>48.48%</strong>. Its efficiency in handling large-scale data and sparse features made it well-suited for this project. However, like XGBoost, it struggled to achieve high recall for the Draw class (<a href="#fig-lightgbm-confusion-matrix" class="quarto-xref">Figure&nbsp;6</a>), leading to a lower macro F1-score. Despite these limitations, LightGBM’s fast training and inference times make it an attractive option for large-scale deployments.</p>
<div id="fig-lightgbm-confusion-matrix" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lightgbm-confusion-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="resources/LGBM.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: Confusion Matrix LightGBM"><img src="resources/LGBM.png" class="img-fluid figure-img"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lightgbm-confusion-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Confusion Matrix LightGBM
</figcaption>
</figure>
</div>
</section>
<section id="feature-engineering-insights" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="feature-engineering-insights"><span class="header-section-number">4.2.5</span> Feature Engineering Insights</h3>
<p>During the final training phase, we decided not to include the engineered <strong>difference</strong> and <strong>ratio</strong> features. This decision was based on validation results showing that the models performed better when only the original features were used. While these engineered features provided valuable insights during exploratory analysis, they may have introduced noise or redundant information that hindered model performance on the full dataset.</p>
</section>
</section>
<section id="validation-and-leaderboard-results" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="validation-and-leaderboard-results"><span class="header-section-number">4.3</span> Validation and Leaderboard Results</h2>
<div id="tbl-validation-leaderboard-results" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-validation-leaderboard-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Validation and leaderboard results for Logistic Regression, Random Forest, XGBoost, and LightGBM models.
</figcaption>
<div aria-describedby="tbl-validation-leaderboard-results-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 19%">
<col style="width: 23%">
<col style="width: 24%">
<col style="width: 11%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Model</strong></th>
<th><strong>Validation Accuracy</strong></th>
<th><strong>Leaderboard Accuracy</strong></th>
<th><strong>Ranking</strong></th>
<th><strong>F1 Score (Macro)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Logistic Regression</td>
<td>45%</td>
<td>43.28%</td>
<td>770</td>
<td>0.40</td>
</tr>
<tr class="even">
<td>Random Forest</td>
<td>49%</td>
<td>48.79%</td>
<td>279</td>
<td>0.35</td>
</tr>
<tr class="odd">
<td>XGBoost</td>
<td>48%</td>
<td>48.49%</td>
<td>464</td>
<td>0.35</td>
</tr>
<tr class="even">
<td>LightGBM</td>
<td>48%</td>
<td>48.48%</td>
<td>470</td>
<td>0.36</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p><a href="#tbl-validation-leaderboard-results" class="quarto-xref">Table&nbsp;5</a> summarizes the performance of each model on the validation set and the challenge leaderboard.</p>
</section>
<section id="discussion-of-results" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="discussion-of-results"><span class="header-section-number">4.4</span> Discussion of Results</h2>
<p>The results highlight the challenges of accurately predicting football match outcomes due to the complexity and variability inherent in the sport. Despite these challenges, the models performed well compared to the baseline, with Random Forest achieving a notable improvement. However, all models struggled with the Draw class, likely due to its lower representation and more ambiguous nature in the dataset.</p>
<p>The primary takeaway from this analysis is the importance of feature selection in sports analytics. This includes not only identifying the most relevant features, but also determining when engineered features may not contribute positively to model performance.</p>
</section>
<section id="limitations" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="limitations"><span class="header-section-number">4.5</span> Limitations</h2>
<ol type="1">
<li><strong>Class Imbalance:</strong> The imbalance in the target variable significantly impacted model performance, particularly for Draw predictions.</li>
<li><strong>Feature Representation:</strong> Despite careful selection, the models may not fully capture the complex dynamics of football matches.</li>
<li><strong>Leaderboard Gap:</strong> The discrepancy between validation and leaderboard performance suggests potential overfitting or differences in test data distribution.</li>
</ol>
</section>
</section>
<section id="conclusion-lessons-learned" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Conclusion &amp; Lessons Learned</h1>
<section id="key-insights" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="key-insights"><span class="header-section-number">5.1</span> Key Insights</h2>
<p>This project explored the use of machine learning techniques to predict football match outcomes, leveraging a dataset rich in team and player statistics. The results demonstrated that ensemble methods, particularly Random Forest, performed robustly on this complex task, achieving a leaderboard ranking significantly above the baseline. Key insights include:</p>
<ul>
<li><strong>Feature Selection Matters:</strong> The decision to exclude engineered features such as differences and ratios during final training proved beneficial, highlighting the importance of testing feature relevance comprehensively.</li>
<li><strong>Class Imbalance Is Challenging:</strong> The imbalance in target classes, particularly the underrepresented Draw category, influenced the models’ ability to generalize, indicating the need for tailored handling of such scenarios in sports analytics.</li>
<li><strong>Model Complexity Balances:</strong> Simpler models like Logistic Regression provided interpretability but struggled with the data’s non-linear relationships. In contrast, advanced ensemble methods such as Random Forest and XGBoost excelled in predictive performance.</li>
</ul>
</section>
<section id="challenges-encountered" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="challenges-encountered"><span class="header-section-number">5.2</span> Challenges Encountered</h2>
<p>Several challenges were faced during this project:</p>
<ol type="1">
<li><strong>Computational Complexity:</strong> Attempts to create an enriched training dataset by applying Cartesian product operations were computationally prohibitive, limiting the exploration of more sophisticated feature combinations.</li>
<li><strong>Limited Additional Statistics:</strong> The dataset lacked certain contextual features, such as live match statistics, player fitness data, and historical betting odds, which could have further enhanced model performance.</li>
<li><strong>Draw Class Prediction:</strong> Predicting Draw outcomes remained consistently difficult due to their ambiguous nature and lower frequency in the dataset.</li>
</ol>
</section>
<section id="future-work" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="future-work"><span class="header-section-number">5.3</span> Future Work</h2>
<p>To further improve model performance and push the boundaries of sports analytics, the following steps are recommended:</p>
<ul>
<li><strong>Augment the Dataset:</strong> Incorporate external data sources, such as live match statistics, player fitness levels, and betting odds, to provide additional context and improve feature richness.</li>
<li><strong>Explore Advanced Models:</strong> Investigate the use of neural networks and hybrid ensemble methods to capture non-linear and hierarchical relationships more effectively.</li>
<li><strong>Improve Draw Predictions:</strong> Develop targeted strategies to handle the Draw class, such as oversampling techniques, cost-sensitive learning, or even specialized sub-models designed for this specific outcome.</li>
</ul>
<p>By addressing these limitations and exploring new opportunities, future iterations of this project can aim for even greater accuracy, insights, and potentially a top-10 ranking on competitive platforms.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="references" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Breiman2001" class="csl-entry" role="listitem">
Breiman, Leo. 2001. <span>“Random Forests.”</span> <em>Machine Learning</em> 45 (1): 5–32.
</div>
<div id="ref-Chen2016" class="csl-entry" role="listitem">
Chen, Tianqi, and Carlos Guestrin. 2016. <span>“XGBoost: A Scalable Tree Boosting System.”</span> In <em>Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>, 785–94. ACM.
</div>
<div id="ref-challengedata" class="csl-entry" role="listitem">
Data, Challenge. 2024. <span>“Challenge Data.”</span> <a href="https://challengedata.ens.fr/">https://challengedata.ens.fr/</a>.
</div>
<div id="ref-Hosmer2013" class="csl-entry" role="listitem">
Hosmer, David W, Stanley Lemeshow, and Rodney X Sturdivant. 2013. <em>Applied Logistic Regression</em>. John Wiley &amp; Sons.
</div>
<div id="ref-Ke2017" class="csl-entry" role="listitem">
Ke, Guolin, Qiwei Meng, Thomas Finley, Taifeng Wang, Wei Chen, Weidong Ma, Qiwei Ye, and Tie-Yan Liu. 2017. <span>“LightGBM: A Highly Efficient Gradient Boosting Decision Tree.”</span> In <em>Advances in Neural Information Processing Systems</em>, 3146–54.
</div>
<div id="ref-challengedata143" class="csl-entry" role="listitem">
Technologies Group, Qube Research &amp;. 2024. <span>“Football : Can You Guess the Winner?”</span> <a href="https://challengedata.ens.fr/participants/challenges/143/">https://challengedata.ens.fr/participants/challenges/143/</a>.
</div>
</div>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content -->  <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script> 
  
</body></html>